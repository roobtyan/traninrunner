runner:
  work_dir: ./runs
  epochs: 5
  valid_every_n_epoch: 1
  log_every_n_iter: 50
  seed: 1337
  best_metric: valid/acc1
  best_mode: max
  freeze:
    targets: ["backbone"]
    bn_eval: true   # keep BatchNorm in frozen targets in eval() during training
    strict: true    # error if a pattern matches nothing

task:
  entry: train.fusion_det3d.fusion_det3d:FusionDet3DTask
  kwargs:
    data:
      data_root: train/fusion_det3d/data/nuscenes/v1.0-mini
      version: v1.0-mini
      queue_length: 1
      img_size: [256, 704]
      num_cams: 6
      use_lidar: false
      class_names:
        - car
        - truck
        - bus
        - pedestrian
        - motorcycle
        - bicycle
        - traffic_cone
        - barrier
    model:
      bev_shape: [75, 60]
      pc_range: [-60.0, -60.0, -4.0, 140.0, 60.0, 4.0]
      voxel_size: [1.0, 0.6, 2.0]
      n_voxels: [75, 60, 1]
      embed_dims: 256
      fpn_out_channels: 256
      fpn_num_outs: 3
      num_heads: 8
      num_levels: 3
      num_points: 8
      num_layers: 1
      num_z: 8
      max_objs: 500
      min_overlap: 0.1
      min_radius: 2
      loss_weights:
        hm: 1.0
        offset: 1.0
        height: 1.0
        dim: 1.0
        rot: 1.0
        vel: 1.0
    train:
      batch_size: 32
      num_workers: 4
    optim:
      name: adamw
      lr: 0.1
      momentum: 0.9
      nesterov: true
      weight_decay: 0.0001
    val:
      score_thresh: 0.1
      max_per_img: 100
      vis_enable: false
      vis_topk: 50
      vis_dir: vis
      speed_thresh: 0.2
      eval_cfg: detection_cvpr_2019
    loss:
      label_smoothing: 0.0
